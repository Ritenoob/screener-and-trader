# =============================================================================
# MINIATURE ENIGMA v5.2.6 - CORRECTED CONFIGURATION
# =============================================================================
# Generated by AGI Audit: 2026-01-27
# CRITICAL: Apply these changes to stop capital loss
# =============================================================================

# =============================================================================
# BOT MODE
# =============================================================================
BOT_MODE=paper                        # CHANGED: Was live - START IN PAPER MODE
PAPER_TRADE_ENABLED=true
STM_MODE=paper

# =============================================================================
# API CREDENTIALS (VERIFY NO WITHDRAWAL PERMS!)
# =============================================================================
KUCOIN_API_KEY=${KUCOIN_API_KEY}
KUCOIN_API_SECRET=${KUCOIN_API_SECRET}
KUCOIN_API_PASSPHRASE=${KUCOIN_API_PASSPHRASE}
KUCOIN_API_VERSION=2

# =============================================================================
# TRADING INTELLIGENCE
# =============================================================================
INTELLIGENCE_ENABLED=true
INTELLIGENCE_LEARNING=true
INTELLIGENCE_MIN_CONFIDENCE=0.5

# =============================================================================
# STRATEGY
# =============================================================================
STRATEGY_PROFILE=conservative         # CHANGED: Was neutral - BE CONSERVATIVE

# =============================================================================
# RISK MANAGEMENT - CRITICAL FIXES
# =============================================================================
STOP_LOSS_ROI=6                       # CHANGED: Was 4 - MORE BREATHING ROOM
STOP_LOSS_HARD_LIMIT=10               # CHANGED: Was 6 - INCREASED BUFFER
TAKE_PROFIT_ROI=15                    # CHANGED: Was 30 - CAPTURE MORE WINS
TRAILING_STOP_ENABLED=true
TRAILING_STOP_ACTIVATION=2            # CHANGED: Was 5 - ENGAGE EARLIER
TRAILING_STOP_TRAIL=1.0               # CHANGED: Was 1.5 - TIGHTER TRAIL
BREAK_EVEN_ENABLED=true
BREAK_EVEN_ACTIVATION=1.0             # CHANGED: Was 1.5 - EARLIER PROTECTION
MAX_DAILY_DRAWDOWN=3.0                # CHANGED: Was 5.0 - STRICTER CONTROL

# =============================================================================
# POSITION SIZING - REDUCED RISK
# =============================================================================
POSITION_SIZE_DEFAULT=2               # CHANGED: Was 3 - SMALLER POSITIONS
POSITION_SIZE_MIN=0.1
POSITION_SIZE_MAX=5.0                 # CHANGED: Was 10.0 - CAPPED LOWER
MAX_OPEN_POSITIONS=5                  # CHANGED: Was 10 - FOCUS ON FEWER

# =============================================================================
# LEVERAGE - CRITICAL FIX
# =============================================================================
LEVERAGE_DEFAULT=6                    # CHANGED: Was 12 - HALVED FOR SAFETY
LEVERAGE_MIN=1
LEVERAGE_MAX=10                       # CHANGED: Was 100 - CAPPED AT 10x
LEVERAGE_VOLATILITY_BASED=true

# =============================================================================
# TIMEFRAMES
# =============================================================================
PRIMARY_TIMEFRAME=30min
SECONDARY_TIMEFRAME=1hour             # CHANGED: Was 2hour - FASTER REACTION
AVAILABLE_TIMEFRAMES=15min,30min,1hour,2hour,4hour

# =============================================================================
# SIGNAL THRESHOLDS - ALIGNED WITH SCORE BANDS
# =============================================================================
SIGNAL_MIN_SCORE=75                   # CHANGED: Was 85 - AVOIDS DEAD ZONE
SIGNAL_STRONG_SCORE=90                # CHANGED: Was 95 - ALIGNED
SIGNAL_EXTREME_SCORE=100              # CHANGED: Was 105 - ALIGNED
SIGNAL_MIN_CONFIDENCE=45              # CHANGED: Was 40 - SLIGHTLY HIGHER
SIGNAL_MIN_INDICATORS=4               # CHANGED: Was 3 - MORE CONFLUENCE
SIGNAL_COOLDOWN_MS=120000             # CHANGED: Was 60000 - LONGER COOLDOWN

# =============================================================================
# SCORE BAND FILTER - FIXED DEAD ZONE
# =============================================================================
SCORE_BAND_FILTER_ENABLED=true
SCORE_BAND_LOW_MIN=70                 # CHANGED: Was 80 - WIDER BAND
SCORE_BAND_LOW_MAX=89                 # CHANGED: Was 84 - COVERS THRESHOLD
SCORE_BAND_HIGH_MIN=90                # CHANGED: Was 95 - CONTINUOUS RANGE
SCORE_BAND_HIGH_MAX=125               # CHANGED: Was 109 - EXTENDED

# =============================================================================
# TF ALIGNMENT
# =============================================================================
MIN_TF_ALIGNMENT=2
MAX_TF_ALIGNMENT=4
BLOCK_FULL_TF_ALIGNMENT=true

# =============================================================================
# ATR VOLATILITY - CRITICAL FOR DYNAMIC STOPS
# =============================================================================
ATR_VOLATILITY_FILTER_ENABLED=true
ATR_POSITION_SIZING_ENABLED=true
ATR_PERIOD=14
ATR_LOW_PERCENTILE=25
ATR_HIGH_PERCENTILE=75
ATR_HYSTERESIS_PCT=3                  # Prevent regime flapping

# =============================================================================
# ENTRY GATES - ALIGNED THRESHOLDS
# =============================================================================
ENTRY_GATES_ENABLED=true
ENTRY_GATE_THRESHOLD=75               # CHANGED: Was 80 - ALIGNED WITH MIN_SCORE
ENTRY_GATE_CONFLUENCE_MIN=4           # CHANGED: Was 4 - CONFIRMED
ENTRY_GATE_CONFIDENCE_MIN=0.85        # CHANGED: Was 0.90 - SLIGHTLY RELAXED
ENTRY_GATE_TREND_ALIGNMENT=true
ENTRY_GATE_MAX_DRAWDOWN=0.03

# =============================================================================
# CONFIDENCE
# =============================================================================
CONFIDENCE_CHECK_ENABLED=true
CONFIDENCE_MIN_THRESHOLD=0.50         # CHANGED: Was 0.45 - HIGHER BAR

# =============================================================================
# COIN SELECTION - QUALITY OVER QUANTITY
# =============================================================================
TOP_COINS_COUNT=100                   # CHANGED: Was 600 - FOCUS ON TOP COINS
MIN_VOLUME_24H=5                      # CHANGED: Was 1 - $5M MINIMUM
SYMBOL_COOLDOWN_MS=1800000            # CHANGED: Was 300000 - 30 MINUTES

# =============================================================================
# SCANNING
# =============================================================================
SCAN_INTERVAL=10000                   # CHANGED: Was 5000 - LESS AGGRESSIVE
BATCH_SIZE=25                         # CHANGED: Was 50 - SMALLER BATCHES

# =============================================================================
# INDICATOR OVERRIDES - CRITICAL FIXES
# =============================================================================
# Re-enable Williams %R on 30min (87.5% win rate - was incorrectly disabled)
WILLIAMS_30MIN_ENABLED=true

# Indicator weights (profit-factor optimized)
WEIGHT_BOLLINGER=20
WEIGHT_EMA=19
WEIGHT_CMF=19
WEIGHT_OBV=18
WEIGHT_MACD=18
WEIGHT_AO=17
WEIGHT_WILLIAMS=22                    # CHANGED: Was 20 - HIGHEST WIN RATE
WEIGHT_STOCHASTIC=20                  # CHANGED: Was 18 - HIGH WIN RATE
WEIGHT_RSI=17
WEIGHT_KDJ=17
WEIGHT_STOCHRSI=20
WEIGHT_CCI=16
WEIGHT_ATR=15

# =============================================================================
# MILESTONE PROFIT LOCKING - EARLIER LOCKS
# =============================================================================
MILESTONE_1_ROI=1.0                   # CHANGED: Was 1.5
MILESTONE_1_LOCK=0.2                  # CHANGED: Was 0.3
MILESTONE_2_ROI=2.0                   # CHANGED: Was 2.5
MILESTONE_2_LOCK=0.8                  # CHANGED: Was 1.0
MILESTONE_3_ROI=3.0                   # CHANGED: Was 3.5
MILESTONE_3_LOCK=1.5                  # CHANGED: Was 2.0
MILESTONE_4_ROI=4.0                   # CHANGED: Was 5.0
MILESTONE_4_LOCK=2.5                  # CHANGED: Was 3.0
MILESTONE_5_ROI=6.0                   # CHANGED: Was 7.5
MILESTONE_5_LOCK=4.0                  # CHANGED: Was 5.0
MILESTONE_6_ROI=8.0                   # CHANGED: Was 10.0
MILESTONE_6_LOCK=6.0                  # CHANGED: Was 7.5

# =============================================================================
# DIVERGENCE
# =============================================================================
DIVERGENCE_PENALTY_PCT=12             # CHANGED: Was 10 - SLIGHTLY HIGHER
DIVERGENCE_MIN_STRENGTH=0.5

# =============================================================================
# DASHBOARD
# =============================================================================
DASHBOARD_PORT=3000
WEBSOCKET_PORT=3001

# =============================================================================
# MONITORING
# =============================================================================
MONITOR_ENABLED=true
MONITOR_REPORT_INTERVAL=30000         # CHANGED: Was 60000 - MORE FREQUENT

# =============================================================================
# LOGGING
# =============================================================================
LOG_LEVEL=debug                       # CHANGED: Was info - MORE VISIBILITY
LOG_CONSOLE=true
LOG_FILE=true
LOG_DIR=./logs

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_PUBLIC_REQUESTS=25         # Below 30/3s limit
RATE_LIMIT_PRIVATE_REQUESTS=60        # Below 75/3s limit
RATE_LIMIT_ORDER_REQUESTS=150         # Below 200/10s limit
RATE_LIMIT_WINDOW_MS=3000

# =============================================================================
# CIRCUIT BREAKER
# =============================================================================
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_THRESHOLD=5           # 5 failures
CIRCUIT_BREAKER_TIMEOUT_MS=60000      # 60s timeout

# =============================================================================
# HEALTH CHECK
# =============================================================================
HEALTH_CHECK_INTERVAL_MS=30000
HEARTBEAT_TIMEOUT_MS=60000
MAX_ORDERBOOK_AGE_MS=5000
MIN_CANDLES_FOR_INDICATORS=100

# =============================================================================
# INVARIANT ENFORCEMENT
# =============================================================================
INVARIANT_CHECK_ENABLED=true
INVARIANT_CHECK_INTERVAL_MS=1000
MIN_LIQUIDATION_BUFFER_PCT=5

# =============================================================================
# EMERGENCY CONTROLS
# =============================================================================
MAX_CONSECUTIVE_LOSSES=3              # Halt after 3 consecutive losses
EMERGENCY_HALT_ON_INVARIANT_FAIL=true
AUTO_CLOSE_ON_EMERGENCY=true

# =============================================================================
# API SAFETY
# =============================================================================
VERIFY_NO_WITHDRAWAL_PERMS=true
IP_ALLOWLIST_ENABLED=true             # Enable at exchange level
